# 验证清单

## 🎯 部署前检查

### 1. 文件完整性检查

#### 前端文件
- [x] `index.html` - 主应用页面
- [x] `login.html` - 登录页面
- [x] `styles.css` - 全局样式
- [x] `app.js` - 主应用逻辑
- [x] `login.js` - 登录逻辑

#### 工具文件
- [x] `debug.html` - API 调试工具
- [x] `check.html` - 系统检查工具
- [x] `test-layout.html` - 布局测试

#### 文档文件
- [x] `README.md` - 使用说明
- [x] `TROUBLESHOOTING.md` - 故障排查
- [x] `CHANGELOG.md` - 更新日志
- [x] `VERIFICATION.md` - 验证清单

### 2. 后端文件检查

#### API 文件
- [x] `utils/api.lua` - API 实现
- [x] `utils/router.lua` - 路由处理
- [x] `utils/cache.lua` - 缓存管理
- [x] `utils/count.lua` - 统计计数
- [x] `utils/ip.lua` - IP 工具
- [x] `utils/logger.lua` - 日志记录
- [x] `utils/localFile.lua` - 文件操作

#### 配置文件
- [x] `conf.d/waf.conf` - WAF 配置
- [x] `conf.d/http.conf` - HTTP 配置
- [x] `conf.d/whiteIp` - IP 白名单
- [x] `conf.d/blackIp` - IP 黑名单
- [x] `conf.d/whitehost` - 域名白名单

### 3. 功能测试清单

#### 登录功能
- [ ] 访问 `http://localhost:9520/login.html`
- [ ] 输入用户名和密码
- [ ] 点击登录按钮
- [ ] 验证是否跳转到主页面
- [ ] 验证会话是否保持

#### 仪表盘功能
- [ ] 访问主页面后默认显示仪表盘
- [ ] 验证统计数据是否正确显示
  - [ ] 总请求数
  - [ ] 拦截请求数
  - [ ] 拦截率
  - [ ] 系统状态
- [ ] 验证攻击类型图表是否正常绘制
- [ ] 等待 30 秒验证自动刷新

#### 规则管理功能
- [ ] 点击侧边栏"规则管理"
- [ ] 验证规则列表是否正常加载
- [ ] 验证规则信息显示
  - [ ] 规则名称
  - [ ] 描述
  - [ ] 危险等级
  - [ ] 检测位置
  - [ ] 状态开关
- [ ] 测试启用/禁用规则开关
- [ ] 点击"查看"按钮查看规则详情
- [ ] 点击"重载配置"按钮

#### IP 管理功能
- [ ] 点击侧边栏"IP 管理"
- [ ] 验证白名单列表是否加载
- [ ] 验证黑名单列表是否加载
- [ ] 测试添加白名单 IP
- [ ] 测试删除白名单 IP
- [ ] 测试添加黑名单 IP
- [ ] 测试删除黑名单 IP

#### 攻击日志功能
- [ ] 点击侧边栏"攻击日志"
- [ ] 输入域名（默认 127.0.0.1）
- [ ] 选择日期
- [ ] 点击"查询"按钮
- [ ] 验证日志列表是否显示
- [ ] 点击"详情"按钮查看日志详情

#### 系统设置功能
- [ ] 点击侧边栏"系统设置"
- [ ] 验证配置文件是否加载
- [ ] 修改配置内容
- [ ] 点击"保存配置"按钮
- [ ] 点击"重载配置"按钮
- [ ] 验证配置是否生效

#### 退出登录功能
- [ ] 点击侧边栏底部"退出登录"
- [ ] 确认退出对话框
- [ ] 验证是否跳转到登录页面
- [ ] 验证会话是否清除

### 4. UI/UX 测试

#### 视觉效果
- [ ] 验证渐变色主题是否正确显示
- [ ] 验证卡片阴影效果
- [ ] 验证按钮悬停效果
- [ ] 验证表格斑马纹和悬停高亮
- [ ] 验证徽章颜色
- [ ] 验证开关按钮动画

#### 交互效果
- [ ] 验证页面切换无刷新
- [ ] 验证 Toast 通知显示和消失
- [ ] 验证加载动画显示
- [ ] 验证模态弹窗打开和关闭
- [ ] 验证表单焦点高亮

#### 响应式设计
- [ ] 在桌面浏览器测试（1920x1080）
- [ ] 在平板尺寸测试（768x1024）
- [ ] 在手机尺寸测试（375x667）
- [ ] 验证侧边栏在小屏幕上的行为
- [ ] 验证按钮在小屏幕上的换行

### 5. API 测试

#### 使用调试工具测试
- [ ] 访问 `http://localhost:9520/debug.html`
- [ ] 测试统计数据 API
- [ ] 测试规则列表 API
- [ ] 测试白名单 API
- [ ] 测试黑名单 API
- [ ] 测试读取配置 API

#### 使用系统检查工具
- [ ] 访问 `http://localhost:9520/check.html`
- [ ] 等待自动检查完成
- [ ] 验证所有检查项是否通过
- [ ] 如有失败项，查看详细错误信息

### 6. 性能测试

#### 加载性能
- [ ] 打开浏览器开发者工具
- [ ] 切换到 Network 面板
- [ ] 刷新页面
- [ ] 验证资源加载时间
  - [ ] HTML < 100ms
  - [ ] CSS < 50ms
  - [ ] JS < 100ms
  - [ ] 总加载时间 < 500ms

#### 运行性能
- [ ] 切换到 Performance 面板
- [ ] 录制页面交互
- [ ] 验证帧率 > 30fps
- [ ] 验证无明显卡顿

### 7. 浏览器兼容性测试

- [ ] Chrome 最新版
- [ ] Firefox 最新版
- [ ] Safari 最新版（Mac）
- [ ] Edge 最新版

### 8. 错误处理测试

#### 网络错误
- [ ] 断开网络连接
- [ ] 尝试加载数据
- [ ] 验证错误提示是否显示

#### API 错误
- [ ] 修改 API URL 为错误地址
- [ ] 尝试请求
- [ ] 验证错误提示

#### 会话过期
- [ ] 清除 Cookie
- [ ] 刷新页面
- [ ] 验证是否跳转到登录页

### 9. 安全测试

#### XSS 测试
- [ ] 在输入框输入 `<script>alert('XSS')</script>`
- [ ] 验证是否被正确转义

#### CSRF 测试
- [ ] 验证 Cookie 是否设置 HttpOnly
- [ ] 验证会话是否有超时机制

### 10. 文档验证

- [ ] 阅读 README.md 确保说明清晰
- [ ] 阅读 TROUBLESHOOTING.md 确保问题覆盖全面
- [ ] 阅读 CHANGELOG.md 确保更新记录完整

## ✅ 验证结果

### 通过标准
- 所有功能测试项通过
- 所有 UI/UX 测试项通过
- 所有 API 测试项通过
- 性能指标达标
- 浏览器兼容性良好
- 错误处理正确
- 安全测试通过
- 文档完整清晰

### 验证签名

```
验证人: _________________
日期: _________________
版本: 2.0.0
状态: [ ] 通过  [ ] 未通过
备注: _________________
```

## 🚀 部署步骤

### 1. 备份旧版本
```bash
# 备份旧的 admin 目录
cp -r conf.d/admin conf.d/admin.backup
```

### 2. 部署新版本
```bash
# 新版本已经在 conf.d/admin 目录中
# 无需额外操作
```

### 3. 重启 Nginx
```bash
# Windows
nginx -s reload

# 或完全重启
nginx -s stop
nginx
```

### 4. 验证部署
```bash
# 访问系统检查页面
http://localhost:9520/check.html
```

### 5. 监控日志
```bash
# 查看 Nginx 错误日志
tail -f e:/website/openresty/logs/error.log
```

## 📞 支持

如有问题，请参考：
1. `TROUBLESHOOTING.md` - 常见问题解决方案
2. `README.md` - 使用说明
3. Nginx 错误日志 - 详细错误信息

---

**验证完成后，请将此清单归档保存。**
